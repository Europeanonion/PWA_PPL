function initProgressTracker(){console.log("Initializing progress tracker..."),updateAllWorkoutProgress(),document.querySelectorAll(".completed-checkbox").forEach((e=>{e.addEventListener("change",(function(){const e=this.closest(".workout-day");e&&updateWorkoutDayProgress(e)}))})),document.querySelectorAll(".phase-btn, .week-btn").forEach((e=>{e.addEventListener("click",(()=>{setTimeout(updateAllWorkoutProgress,100)}))}))}function updateAllWorkoutProgress(){document.querySelectorAll(".week-content.active .workout-day").forEach((e=>{updateWorkoutDayProgress(e)}))}function updateWorkoutDayProgress(e){const o=e.querySelectorAll(".exercise-row"),t=new Set,r=new Set;o.forEach((e=>{const o=e.querySelector(".exercise-name");if(!o)return;const s=o.querySelector(".info-icon");if(!s)return;const n=s.getAttribute("onclick");if(!n)return;const c=n.match(/toggleNotes\('(.+?)-notes'\)/);if(!c||!c[1])return;const l=c[1];t.add(l);const a=e.querySelectorAll(`.completed-checkbox[data-exercise="${l}"]`);let i=!1;a.forEach((e=>{e.checked&&(i=!0)})),i?(r.add(l),e.classList.add("exercise-completed")):e.classList.remove("exercise-completed")}));const s=t.size,n=r.size,c=s>0?Math.round(n/s*100):0,l=e.querySelector(".progress-bar-fill");l&&(l.style.width=`${c}%`,l.style.backgroundColor=100===c?"var(--success-color)":c>50?"var(--brand-gold)":c>0?"var(--warning-color)":"var(--neutral-400)");const a=e.querySelector(".progress-stats");a&&(a.innerHTML=`\n      <span>${n}/${s} exercises completed</span>\n      <span>${c}%</span>\n    `);const i=e.querySelector(".day-header");if(i)if(100===c){if(!i.querySelector(".completion-badge")){const e=document.createElement("span");e.className="completion-badge",e.innerHTML="✓",e.title="Workout Complete",i.appendChild(e)}}else{const e=i.querySelector(".completion-badge");e&&e.remove()}saveProgressToLocalStorage(e,r)}function saveProgressToLocalStorage(e,o){if(!window.workoutStorage)return;const t=e.closest(".phase-content"),r=e.closest(".week-content");if(!t||!r)return;const s=t.id,n=r.id.split("-")[1],c=e.querySelector(".day-header").textContent.toLowerCase().replace(/\s+/g,"").replace("#",""),l=(s.replace("phase",""),n.replace("week",""),window.workoutStorage.loadAll());l.progress||(l.progress={}),l.progress[s]||(l.progress[s]={}),l.progress[s][n]||(l.progress[s][n]={}),l.progress[s][n][c]||(l.progress[s][n][c]={date:(new Date).toISOString().split("T")[0],exercises:{}});e.querySelectorAll(".exercise-row").forEach((e=>{const t=e.querySelector(".exercise-name");if(!t)return;const r=t.querySelector(".info-icon");if(!r)return;const a=r.getAttribute("onclick");if(!a)return;const i=a.match(/toggleNotes\('(.+?)-notes'\)/);if(!i||!i[1])return;const d=i[1],u=o.has(d);l.progress[s][n][c].exercises[d]?l.progress[s][n][c].exercises[d].completed=u:l.progress[s][n][c].exercises[d]={completed:u}})),window.workoutStorage.saveAll(l)}function loadProgressFromLocalStorage(){if(!window.workoutStorage)return;const e=window.workoutStorage.loadAll();if(!e.progress)return;document.querySelectorAll(".workout-day").forEach((o=>{const t=o.closest(".phase-content"),r=o.closest(".week-content");if(!t||!r)return;const s=t.id,n=r.id.split("-")[1],c=o.querySelector(".day-header").textContent.toLowerCase().replace(/\s+/g,"").replace("#","");if(e.progress[s]&&e.progress[s][n]&&e.progress[s][n][c]){const t=e.progress[s][n][c];if(t.exercises)for(const e in t.exercises){if(t.exercises[e].completed){o.querySelectorAll(".exercise-row").forEach((o=>{const t=o.querySelector(".info-icon");if(!t)return;const r=t.getAttribute("onclick");if(!r)return;const s=r.match(/toggleNotes\('(.+?)-notes'\)/);if(s&&s[1]&&s[1]===e){o.classList.add("exercise-completed");o.querySelectorAll(`.completed-checkbox[data-exercise="${e}"]`).forEach((e=>{e.checked=!0;const o=e.closest(".set-row");o&&o.classList.add("completed")}))}}))}}updateWorkoutDayProgress(o)}}))}document.addEventListener("DOMContentLoaded",(()=>{initProgressTracker(),loadProgressFromLocalStorage()})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.createElement("style");e.textContent='\n    .exercise-completed {\n      position: relative;\n    }\n    \n    .exercise-completed::after {\n      content: "✓";\n      position: absolute;\n      top: 50%;\n      right: 10px;\n      transform: translateY(-50%);\n      color: var(--success-color);\n      font-size: 18px;\n      font-weight: bold;\n    }\n    \n    .completion-badge {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      width: 24px;\n      height: 24px;\n      background-color: var(--success-color);\n      color: white;\n      border-radius: 50%;\n      margin-left: 10px;\n      font-size: 14px;\n      font-weight: bold;\n    }\n  ',document.head.appendChild(e)}));