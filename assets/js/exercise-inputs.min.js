function getWeightUnit(){if(window.workoutStorage){const e=window.workoutStorage.loadAll();return e.settings?.units||"lb"}return"lb"}function setWeightUnit(e){if(window.workoutStorage){const t=window.workoutStorage.loadAll();t.settings.units=e,window.workoutStorage.saveAll(t),updateWeightPlaceholders(e),window.workoutStorage.showFeedback(`Weight unit changed to ${e}`,"success")}}function updateWeightPlaceholders(e){document.querySelectorAll(".weight-input").forEach((t=>{t.placeholder=e}))}function createWeightUnitSelector(){const e=getWeightUnit(),t=document.createElement("div");t.className="weight-unit-selector";const n=document.createElement("label");n.textContent="Weight Unit: ",t.appendChild(n);const o=document.createElement("label");o.className="unit-label",o.innerHTML='<input type="radio" name="weight-unit" value="kg"> kg',t.appendChild(o);const c=document.createElement("label");c.className="unit-label",c.innerHTML='<input type="radio" name="weight-unit" value="lb"> lb',t.appendChild(c);const i=t.querySelector(`input[value="${e}"]`);return i&&(i.checked=!0),t.querySelectorAll('input[type="radio"]').forEach((e=>{e.addEventListener("change",(function(){setWeightUnit(this.value)}))})),t}function handleExerciseSetChange(e){const t=e.target,n=t.dataset.exercise,o=parseInt(t.dataset.set)-1,c=document.querySelector(".phase-content.active").id.replace("phase",""),i=document.querySelector(`#phase${c} .week-content.active`).id.split("-")[1].replace("week",""),a=t.closest(".workout-day").querySelector(".day-header").textContent.toLowerCase().replace(/\s+/g,"").replace("#","");let r=null,s=!1;if(t.classList.contains("weight-input")){r=t.value?parseFloat(t.value):null;const e=t.parentNode.querySelector(".completed-checkbox");s=!!e&&e.checked}else if(t.classList.contains("completed-checkbox")){const e=t.parentNode.querySelector(".weight-input");r=e&&e.value?parseFloat(e.value):null,s=t.checked}n&&o>=0&&window.workoutStorage&&window.workoutStorage.saveSet(c,i,a,n,o,r,null,s)}function generateExerciseInputs(){console.log("Generating exercise inputs...");const e=getWeightUnit();document.querySelectorAll(".exercise-row").forEach((t=>{const n=t.querySelector(".exercise-name");if(!n)return;const o=n.querySelector(".info-icon");if(!o)return;const c=o.getAttribute("onclick");if(!c)return;const i=c.match(/toggleNotes\('(.+?)-notes'\)/);if(!i||!i[1])return;const a=i[1],r=t.querySelector("td.exercise-data:nth-child(3)");if(!r)return;if(r.querySelector(".set-inputs"))return;let s=parseInt(r.textContent.trim());isNaN(s)&&(s=1);const l=document.createElement("div");l.className="set-inputs";for(let t=1;t<=s;t++){const n=document.createElement("div");n.className="set-row";const o=document.createElement("input");o.type="number",o.className="weight-input",o.dataset.exercise=a,o.dataset.set=t,o.placeholder=e,o.addEventListener("change",handleExerciseSetChange),o.addEventListener("blur",handleExerciseSetChange);const c=document.createElement("input");c.type="checkbox",c.className="completed-checkbox",c.dataset.exercise=a,c.dataset.set=t,c.addEventListener("change",(function(e){this.checked?this.closest(".set-row").classList.add("completed"):this.closest(".set-row").classList.remove("completed"),handleExerciseSetChange(e)})),n.appendChild(o),n.appendChild(c),l.appendChild(n)}r.textContent="",r.appendChild(l)})),console.log("Exercise inputs generation complete")}function addWeightUnitSelector(){const e=document.querySelector(".data-management");if(!e)return;const t=createWeightUnitSelector();e.appendChild(t)}document.addEventListener("DOMContentLoaded",(function(){console.log("DOM loaded, initializing exercise inputs..."),addWeightUnitSelector(),setTimeout(generateExerciseInputs,200),document.querySelectorAll(".phase-btn").forEach((e=>{e.addEventListener("click",(()=>{setTimeout(generateExerciseInputs,200)}))})),document.querySelectorAll(".week-btn").forEach((e=>{e.addEventListener("click",(()=>{setTimeout(generateExerciseInputs,200)}))}))}));